{"remainingRequest":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/thread-loader/dist/cjs.js!/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/babel-loader/lib/index.js!/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/src/views/Blog/components/BlogComment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/src/views/Blog/components/BlogComment.vue","mtime":1622901908805},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IE1lc3NhZ2VBcmVhIGZyb20gIkAvY29tcG9uZW50cy9NZXNzYWdlQXJlYSI7CmltcG9ydCBmZXRjaERhdGEgZnJvbSAiQC9taXhpbnMvZmV0Y2hEYXRhLmpzIjsKaW1wb3J0IHsgZ2V0Q29tbWVudHMsIHBvc3RDb21tZW50IH0gZnJvbSAiQC9hcGkvYmxvZy5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFtmZXRjaERhdGEoewogICAgdG90YWw6IDAsCiAgICByb3dzOiBbXQogIH0pXSwKICBjb21wb25lbnRzOiB7CiAgICBNZXNzYWdlQXJlYQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwYWdlOiAxLAogICAgICBsaW1pdDogMTAKICAgIH07CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuJGJ1cy4kb24oIm1haW5TY3JvbGwiLCB0aGlzLmhhbmRsZVNjcm9sbCk7CiAgfSwKCiAgZGVzdHJveWVkKCkgewogICAgdGhpcy4kYnVzLiRvZmYoIm1haW5TY3JvbGwiLCB0aGlzLmhhbmRsZVNjcm9sbCk7CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIGhhc01vcmUoKSB7CiAgICAgIHJldHVybiB0aGlzLmRhdGEucm93cy5sZW5ndGggPCB0aGlzLmRhdGEudG90YWw7CiAgICB9CgogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlU2Nyb2xsKGRvbSkgewogICAgICBpZiAodGhpcy5pc0xvYWRpbmcgfHwgIWRvbSkgewogICAgICAgIC8vIOebruWJjeato+WcqOWKoOi9veabtOWkmgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgcmFuZ2UgPSAxMDA7IC8vIOmhtuS4gOS4quWPr+aOpeWPl+eahOiMg+WbtO+8jOWcqOi/meS4quiMg+WbtOWGhemDveeul+i+vuWIsOS6huW6lemDqAoKICAgICAgY29uc3QgZGVjID0gTWF0aC5hYnMoZG9tLnNjcm9sbFRvcCArIGRvbS5jbGllbnRIZWlnaHQgLSBkb20uc2Nyb2xsSGVpZ2h0KTsKCiAgICAgIGlmIChkZWMgPD0gcmFuZ2UpIHsKICAgICAgICB0aGlzLmZldGNoTW9yZSgpOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIGZldGNoRGF0YSgpIHsKICAgICAgcmV0dXJuIGF3YWl0IGdldENvbW1lbnRzKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCwgdGhpcy5wYWdlLCB0aGlzLmxpbWl0KTsKICAgIH0sCgogICAgLy8g5Yqg6L295LiL5LiA6aG1CiAgICBhc3luYyBmZXRjaE1vcmUoKSB7CiAgICAgIGlmICghdGhpcy5oYXNNb3JlKSB7CiAgICAgICAgLy8g5rKh5pyJ5pu05aSa5ZWmCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7CiAgICAgIHRoaXMucGFnZSsrOwogICAgICBjb25zdCByZXNwID0gYXdhaXQgdGhpcy5mZXRjaERhdGEoKTsKICAgICAgdGhpcy5kYXRhLnRvdGFsID0gcmVzcC50b3RhbDsKICAgICAgdGhpcy5kYXRhLnJvd3MgPSB0aGlzLmRhdGEucm93cy5jb25jYXQocmVzcC5yb3dzKTsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgIH0sCgogICAgYXN5bmMgaGFuZGxlU3VibWl0KGZvcm1EYXRhLCBjYWxsYmFjaykgewogICAgICBjb25zdCByZXNwID0gYXdhaXQgcG9zdENvbW1lbnQoewogICAgICAgIGJsb2dJZDogdGhpcy4kcm91dGUucGFyYW1zLmlkLAogICAgICAgIC4uLmZvcm1EYXRhCiAgICAgIH0pOwogICAgICB0aGlzLmRhdGEucm93cy51bnNoaWZ0KHJlc3ApOwogICAgICB0aGlzLmRhdGEudG90YWwrKzsKICAgICAgY2FsbGJhY2soIuivhOiuuuaIkOWKnyIpOyAvLyDlkYror4nlrZDnu4Tku7bvvIzmiJHov5novrnlpITnkIblrozkuobvvIzkvaDnu6fnu60KICAgIH0KCiAgfQp9Ow=="},{"version":3,"sources":["BlogComment.vue"],"names":[],"mappings":";;;;;;;;;;;;AAaA,OAAA,WAAA,MAAA,0BAAA;AACA,OAAA,SAAA,MAAA,uBAAA;AACA,SAAA,WAAA,EAAA,WAAA,QAAA,eAAA;AACA,eAAA;AACA,EAAA,MAAA,EAAA,CAAA,SAAA,CAAA;AAAA,IAAA,KAAA,EAAA,CAAA;AAAA,IAAA,IAAA,EAAA;AAAA,GAAA,CAAA,CADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA;AADA,GAFA;;AAKA,EAAA,IAAA,GAAA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,CADA;AAEA,MAAA,KAAA,EAAA;AAFA,KAAA;AAIA,GAVA;;AAWA,EAAA,OAAA,GAAA;AACA,SAAA,IAAA,CAAA,GAAA,CAAA,YAAA,EAAA,KAAA,YAAA;AACA,GAbA;;AAcA,EAAA,SAAA,GAAA;AACA,SAAA,IAAA,CAAA,IAAA,CAAA,YAAA,EAAA,KAAA,YAAA;AACA,GAhBA;;AAiBA,EAAA,QAAA,EAAA;AACA,IAAA,OAAA,GAAA;AACA,aAAA,KAAA,IAAA,CAAA,IAAA,CAAA,MAAA,GAAA,KAAA,IAAA,CAAA,KAAA;AACA;;AAHA,GAjBA;AAsBA,EAAA,OAAA,EAAA;AACA,IAAA,YAAA,CAAA,GAAA,EAAA;AACA,UAAA,KAAA,SAAA,IAAA,CAAA,GAAA,EAAA;AACA;AACA;AACA;;AACA,YAAA,KAAA,GAAA,GAAA,CALA,CAKA;;AACA,YAAA,GAAA,GAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,SAAA,GAAA,GAAA,CAAA,YAAA,GAAA,GAAA,CAAA,YAAA,CAAA;;AACA,UAAA,GAAA,IAAA,KAAA,EAAA;AACA,aAAA,SAAA;AACA;AACA,KAXA;;AAYA,UAAA,SAAA,GAAA;AACA,aAAA,MAAA,WAAA,CAAA,KAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,KAAA,IAAA,EAAA,KAAA,KAAA,CAAA;AACA,KAdA;;AAeA;AACA,UAAA,SAAA,GAAA;AACA,UAAA,CAAA,KAAA,OAAA,EAAA;AACA;AACA;AACA;;AACA,WAAA,SAAA,GAAA,IAAA;AACA,WAAA,IAAA;AACA,YAAA,IAAA,GAAA,MAAA,KAAA,SAAA,EAAA;AACA,WAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA;AACA,WAAA,IAAA,CAAA,IAAA,GAAA,KAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AACA,WAAA,SAAA,GAAA,KAAA;AACA,KA3BA;;AA4BA,UAAA,YAAA,CAAA,QAAA,EAAA,QAAA,EAAA;AACA,YAAA,IAAA,GAAA,MAAA,WAAA,CAAA;AACA,QAAA,MAAA,EAAA,KAAA,MAAA,CAAA,MAAA,CAAA,EADA;AAEA,WAAA;AAFA,OAAA,CAAA;AAIA,WAAA,IAAA,CAAA,IAAA,CAAA,OAAA,CAAA,IAAA;AACA,WAAA,IAAA,CAAA,KAAA;AACA,MAAA,QAAA,CAAA,MAAA,CAAA,CAPA,CAOA;AACA;;AApCA;AAtBA,CAAA","sourcesContent":["<template>\n  <div class=\"blog-comment-container\">\n    <MessageArea\n      title=\"评论列表\"\n      :subTitle=\"`(${data.total})`\"\n      :list=\"data.rows\"\n      :isListLoading=\"isLoading\"\n      @submit=\"handleSubmit\"\n    />\n  </div>\n</template>\n\n<script>\nimport MessageArea from \"@/components/MessageArea\";\nimport fetchData from \"@/mixins/fetchData.js\";\nimport { getComments, postComment } from \"@/api/blog.js\";\nexport default {\n  mixins: [fetchData({ total: 0, rows: [] })],\n  components: {\n    MessageArea,\n  },\n  data() {\n    return {\n      page: 1,\n      limit: 10,\n    };\n  },\n  created() {\n    this.$bus.$on(\"mainScroll\", this.handleScroll);\n  },\n  destroyed() {\n    this.$bus.$off(\"mainScroll\", this.handleScroll);\n  },\n  computed: {\n    hasMore() {\n      return this.data.rows.length < this.data.total;\n    },\n  },\n  methods: {\n    handleScroll(dom) {\n      if (this.isLoading || !dom) {\n        // 目前正在加载更多\n        return;\n      }\n      const range = 100; // 顶一个可接受的范围，在这个范围内都算达到了底部\n      const dec = Math.abs(dom.scrollTop + dom.clientHeight - dom.scrollHeight);\n      if (dec <= range) {\n        this.fetchMore();\n      }\n    },\n    async fetchData() {\n      return await getComments(this.$route.params.id, this.page, this.limit);\n    },\n    // 加载下一页\n    async fetchMore() {\n      if (!this.hasMore) {\n        // 没有更多啦\n        return;\n      }\n      this.isLoading = true;\n      this.page++;\n      const resp = await this.fetchData();\n      this.data.total = resp.total;\n      this.data.rows = this.data.rows.concat(resp.rows);\n      this.isLoading = false;\n    },\n    async handleSubmit(formData, callback) {\n      const resp = await postComment({\n        blogId: this.$route.params.id,\n        ...formData,\n      });\n      this.data.rows.unshift(resp);\n      this.data.total++;\n      callback(\"评论成功\"); // 告诉子组件，我这边处理完了，你继续\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n.blog-comment-container {\n  margin: 30px 0;\n}\n</style>\n"],"sourceRoot":"src/views/Blog/components"}]}