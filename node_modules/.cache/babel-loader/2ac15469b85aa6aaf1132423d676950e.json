{"remainingRequest":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/thread-loader/dist/cjs.js!/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/babel-loader/lib/index.js!/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/src/directives/lazy.js","dependencies":[{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/src/directives/lazy.js","mtime":1622901908735},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy9qaXhpbnlhbi9EZXNrdG9wL1x1NTI0RFx1N0FFRi9EdVlpLVZ1ZTIvMS4gXHU1MTY1XHU5NUU4LzM5LiBcdTYyNTNcdTUzMDVcdTdFRDNcdTY3OUNcdTUyMDZcdTY3OTAvXHU4QkZFXHU1ODAyXHU0RUUzXHU3ODAxL215LXNpdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiOwppbXBvcnQgZXZlbnRCdXMgZnJvbSAiQC9ldmVudEJ1cyI7CmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSAiQC91dGlscyI7CmltcG9ydCBkZWZhdWx0R2lmIGZyb20gIkAvYXNzZXRzL2RlZmF1bHQuZ2lmIjsKdmFyIGltZ3MgPSBbXTsKCmZ1bmN0aW9uIHNldEltYWdlKGltZykgewogIGltZy5kb20uc3JjID0gZGVmYXVsdEdpZjsgLy8g5YWI5pqC5pe25L2/55So552A6buY6K6k5Zu+54mHCiAgLy8g5aSE55CG5Zu+54mHCiAgLy8g6K+l5Zu+54mH5piv5ZCm5Zyo6KeG5Y+j6IyD5Zu05YaFCgogIHZhciBjbGllbnRIZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0OwogIHZhciByZWN0ID0gaW1nLmRvbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICB2YXIgaGVpZ2h0ID0gcmVjdC5oZWlnaHQgfHwgMTUwOwoKICBpZiAocmVjdC50b3AgPj0gLWhlaWdodCAmJiByZWN0LnRvcCA8PSBjbGllbnRIZWlnaHQpIHsKICAgIC8vIOWcqOinhuWPo+iMg+WbtOWGhQogICAgLy8gY29uc3QgdGVtcEltZyA9IG5ldyBJbWFnZSgpOwogICAgLy8gdGVtcEltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgIC8vICAgLy8g5b2T55yf5a6e5Zu+54mH5Yqg6L295a6M5oiQ5LmL5ZCOCiAgICAvLyAgIGltZy5kb20uc3JjID0gaW1nLnNyYzsKICAgIC8vIH07CiAgICAvLyB0ZW1wSW1nLnNyYyA9IGltZy5zcmM7CiAgICBpbWcuZG9tLnNyYyA9IGltZy5zcmM7CiAgICBpbWdzID0gaW1ncy5maWx0ZXIoZnVuY3Rpb24gKGkpIHsKICAgICAgcmV0dXJuIGkgIT09IGltZzsKICAgIH0pOwogIH0KfSAvLyDluIzmnJvvvIzosIPnlKjor6Xlh73mlbDvvIzlsLHlj6/ku6Xorr7nva7pgqPkupvlkIjpgILnmoTlm77niYcKCgpmdW5jdGlvbiBzZXRJbWFnZXMoKSB7CiAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGltZ3MpLAogICAgICBfc3RlcDsKCiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBpbWcgPSBfc3RlcC52YWx1ZTsKICAgICAgLy8g5aSE55CG6K+l5Zu+54mHCiAgICAgIHNldEltYWdlKGltZyk7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3IuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3IuZigpOwogIH0KfQoKZnVuY3Rpb24gaGFuZGxlU2Nyb2xsKCkgewogIHNldEltYWdlcygpOwp9CgpldmVudEJ1cy4kb24oIm1haW5TY3JvbGwiLCBkZWJvdW5jZShoYW5kbGVTY3JvbGwsIDUwKSk7CmV4cG9ydCBkZWZhdWx0IHsKICBpbnNlcnRlZDogZnVuY3Rpb24gaW5zZXJ0ZWQoZWwsIGJpbmRpbmdzKSB7CiAgICB2YXIgaW1nID0gewogICAgICBkb206IGVsLAogICAgICBzcmM6IGJpbmRpbmdzLnZhbHVlCiAgICB9OwogICAgaW1ncy5wdXNoKGltZyk7IC8vIOeri+WNs+WkhOeQhuWugwoKICAgIHNldEltYWdlKGltZyk7CiAgfSwKICB1bmJpbmQ6IGZ1bmN0aW9uIHVuYmluZChlbCkgewogICAgaW1ncyA9IGltZ3MuZmlsdGVyKGZ1bmN0aW9uIChpbWcpIHsKICAgICAgcmV0dXJuIGltZy5kb20gIT09IGVsOwogICAgfSk7CiAgfQp9Ow=="},{"version":3,"sources":["/Users/jixinyan/Desktop/前端/DuYi-Vue2/1. 入门/39. 打包结果分析/课堂代码/my-site/src/directives/lazy.js"],"names":["eventBus","debounce","defaultGif","imgs","setImage","img","dom","src","clientHeight","document","documentElement","rect","getBoundingClientRect","height","top","filter","i","setImages","handleScroll","$on","inserted","el","bindings","value","push","unbind"],"mappings":";;AAAA,OAAOA,QAAP,MAAqB,YAArB;AACA,SAASC,QAAT,QAAyB,SAAzB;AACA,OAAOC,UAAP,MAAuB,sBAAvB;AAEA,IAAIC,IAAI,GAAG,EAAX;;AAEA,SAASC,QAAT,CAAkBC,GAAlB,EAAuB;AACrBA,EAAAA,GAAG,CAACC,GAAJ,CAAQC,GAAR,GAAcL,UAAd,CADqB,CACK;AAC1B;AACA;;AACA,MAAMM,YAAY,GAAGC,QAAQ,CAACC,eAAT,CAAyBF,YAA9C;AACA,MAAMG,IAAI,GAAGN,GAAG,CAACC,GAAJ,CAAQM,qBAAR,EAAb;AACA,MAAMC,MAAM,GAAGF,IAAI,CAACE,MAAL,IAAe,GAA9B;;AACA,MAAIF,IAAI,CAACG,GAAL,IAAY,CAACD,MAAb,IAAuBF,IAAI,CAACG,GAAL,IAAYN,YAAvC,EAAqD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACAH,IAAAA,GAAG,CAACC,GAAJ,CAAQC,GAAR,GAAcF,GAAG,CAACE,GAAlB;AACAJ,IAAAA,IAAI,GAAGA,IAAI,CAACY,MAAL,CAAY,UAACC,CAAD;AAAA,aAAOA,CAAC,KAAKX,GAAb;AAAA,KAAZ,CAAP;AACD;AACF,C,CAED;;;AACA,SAASY,SAAT,GAAqB;AAAA,6CACDd,IADC;AAAA;;AAAA;AACnB,wDAAwB;AAAA,UAAbE,GAAa;AACtB;AACAD,MAAAA,QAAQ,CAACC,GAAD,CAAR;AACD;AAJkB;AAAA;AAAA;AAAA;AAAA;AAKpB;;AAED,SAASa,YAAT,GAAwB;AACtBD,EAAAA,SAAS;AACV;;AAEDjB,QAAQ,CAACmB,GAAT,CAAa,YAAb,EAA2BlB,QAAQ,CAACiB,YAAD,EAAe,EAAf,CAAnC;AAEA,eAAe;AACbE,EAAAA,QADa,oBACJC,EADI,EACAC,QADA,EACU;AACrB,QAAMjB,GAAG,GAAG;AACVC,MAAAA,GAAG,EAAEe,EADK;AAEVd,MAAAA,GAAG,EAAEe,QAAQ,CAACC;AAFJ,KAAZ;AAIApB,IAAAA,IAAI,CAACqB,IAAL,CAAUnB,GAAV,EALqB,CAMrB;;AACAD,IAAAA,QAAQ,CAACC,GAAD,CAAR;AACD,GATY;AAUboB,EAAAA,MAVa,kBAUNJ,EAVM,EAUF;AACTlB,IAAAA,IAAI,GAAGA,IAAI,CAACY,MAAL,CAAY,UAACV,GAAD;AAAA,aAASA,GAAG,CAACC,GAAJ,KAAYe,EAArB;AAAA,KAAZ,CAAP;AACD;AAZY,CAAf","sourcesContent":["import eventBus from \"@/eventBus\";\nimport { debounce } from \"@/utils\";\nimport defaultGif from \"@/assets/default.gif\";\n\nlet imgs = [];\n\nfunction setImage(img) {\n  img.dom.src = defaultGif; // 先暂时使用着默认图片\n  // 处理图片\n  // 该图片是否在视口范围内\n  const clientHeight = document.documentElement.clientHeight;\n  const rect = img.dom.getBoundingClientRect();\n  const height = rect.height || 150;\n  if (rect.top >= -height && rect.top <= clientHeight) {\n    // 在视口范围内\n    // const tempImg = new Image();\n    // tempImg.onload = function() {\n    //   // 当真实图片加载完成之后\n    //   img.dom.src = img.src;\n    // };\n    // tempImg.src = img.src;\n    img.dom.src = img.src;\n    imgs = imgs.filter((i) => i !== img);\n  }\n}\n\n// 希望，调用该函数，就可以设置那些合适的图片\nfunction setImages() {\n  for (const img of imgs) {\n    // 处理该图片\n    setImage(img);\n  }\n}\n\nfunction handleScroll() {\n  setImages();\n}\n\neventBus.$on(\"mainScroll\", debounce(handleScroll, 50));\n\nexport default {\n  inserted(el, bindings) {\n    const img = {\n      dom: el,\n      src: bindings.value,\n    };\n    imgs.push(img);\n    // 立即处理它\n    setImage(img);\n  },\n  unbind(el) {\n    imgs = imgs.filter((img) => img.dom !== el);\n  },\n};\n"]}]}